<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MentalIA - Teste de Relat√≥rio</title>
</head>
<body>
    <h1>Teste de Gera√ß√£o de Relat√≥rio</h1>
    <button onclick="testReport()">Gerar Relat√≥rio de Teste</button>
    <div id="result"></div>

    <script src="js/storage.js"></script>
    <script src="js/ai_analysis.js"></script>
    <script>
        async function testReport() {
            try {
                console.log('üß™ Iniciando teste de relat√≥rio...');

                // Verificar se storage est√° dispon√≠vel
                if (!window.mentalStorage) {
                    throw new Error('Storage n√£o dispon√≠vel');
                }

                // Obter entradas
                const entries = await window.mentalStorage.getAllMoodEntries();
                console.log('üìä Entradas encontradas:', entries.length, entries);

                if (entries.length === 0) {
                    document.getElementById('result').innerHTML = '<p style="color: orange;">Nenhuma entrada encontrada. Adicione dados primeiro.</p>';
                    return;
                }

                // Verificar se aiAnalysis est√° dispon√≠vel
                if (!window.aiAnalysis) {
                    throw new Error('AI Analysis n√£o dispon√≠vel');
                }

                // Gerar relat√≥rio
                console.log('üß† Gerando relat√≥rio...');
                const report = await window.aiAnalysis.generateReport(entries);
                console.log('‚úÖ Relat√≥rio gerado:', report);

                // Exibir resultado
                document.getElementById('result').innerHTML = `
                    <h2>${report.title}</h2>
                    <h3>${report.subtitle}</h3>
                    <div style="background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px;">
                        <pre>${JSON.stringify(report, null, 2)}</pre>
                    </div>
                `;

            } catch (error) {
                console.error('‚ùå Erro no teste:', error);
                document.getElementById('result').innerHTML = `
                    <p style="color: red;">Erro: ${error.message}</p>
                    <pre style="background: #ffe6e6; padding: 10px; border-radius: 5px;">${error.stack}</pre>
                `;
            }
        }
    </script>
</body>
</html>