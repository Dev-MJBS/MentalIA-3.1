<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Download PDF Mobile</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <h1>Teste de Download PDF - Mobile vs Desktop</h1>
    <button onclick="testPDFDownload()">Testar Download PDF</button>
    <div id="result"></div>

    <script>
        function testPDFDownload() {
            const resultDiv = document.getElementById('result');

            // Detectar dispositivo m√≥vel
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
                            (window.innerWidth <= 768 && window.innerHeight <= 1024);

            resultDiv.innerHTML = `
                <p><strong>Dispositivo detectado:</strong> ${isMobile ? 'M√ìVEL' : 'DESKTOP'}</p>
                <p><strong>User Agent:</strong> ${navigator.userAgent}</p>
                <p><strong>Tamanho da tela:</strong> ${window.innerWidth}x${window.innerHeight}</p>
                <p><strong>Testando download...</strong></p>
            `;

            try {
                // Criar PDF simples
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF();

                pdf.text('Teste de PDF - MentalIA', 20, 30);
                pdf.text(`Gerado em: ${new Date().toLocaleString()}`, 20, 50);
                pdf.text(`Dispositivo: ${isMobile ? 'Mobile' : 'Desktop'}`, 20, 70);

                const filename = `teste_pdf_${isMobile ? 'mobile' : 'desktop'}.pdf`;

                if (isMobile) {
                    // Estrat√©gia mobile
                    resultDiv.innerHTML += '<p>üîÑ Usando estrat√©gia mobile...</p>';

                    const pdfBlob = pdf.output('blob');
                    const pdfUrl = URL.createObjectURL(pdfBlob);

                    const link = document.createElement('a');
                    link.href = pdfUrl;
                    link.download = filename;
                    link.style.display = 'none';

                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);

                    setTimeout(() => URL.revokeObjectURL(pdfUrl), 1000);

                    resultDiv.innerHTML += '<p>‚úÖ Download mobile iniciado!</p>';
                } else {
                    // Estrat√©gia desktop
                    resultDiv.innerHTML += '<p>üíª Usando estrat√©gia desktop...</p>';
                    pdf.save(filename);
                    resultDiv.innerHTML += '<p>‚úÖ Download desktop conclu√≠do!</p>';
                }

            } catch (error) {
                resultDiv.innerHTML += `<p>‚ùå Erro: ${error.message}</p>`;
                console.error('Erro no teste:', error);
            }
        }
    </script>
</body>
</html>